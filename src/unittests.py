import unittest
import analyze_malware

# TODO #4

TEST = analyze_malware.AnalyzeMalware('python-3.9.4-amd64.exe')

class TestMalwareAnalysis(unittest.TestCase):
    def test_get_md5(self):
        self.assertTrue(TEST.get_hash(), 'File hash to be returned')

    def test_search_strings(self):
        self.assertIsNotNone(TEST.search_strings(), 'Strings to be returned')

    def test_registry_baseline(self):
        self.assertIsNotNone(TEST.registry_baseline())

    def test_network_baseline(self):
        # needs to check that it opened the sockets not that there are open ports...
        self.assertIsNotNone(TEST.network_baseline())
        
if __name__ == '__main__':
    unittest.main()
