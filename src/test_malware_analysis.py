import unittest
from malware_analysis import malwareanalysis

TEST = malwareanalysis.AnalyzeMalware('python-3.9.5-amd64.exe')

class TestMalwareAnalysis(unittest.TestCase):
    def test_get_md5(self):
        self.assertTrue(TEST.get_hash(), 'File hash to be returned')

    def test_search_strings(self):
        self.assertIsNotNone(TEST.search_strings(), 'Strings to be returned')


    def test_registry_baseline(self):
        windows_machine = True
        try:
            self.assertIsNotNone(TEST.registry_baseline())
        except (NameError, ModuleNotFoundError):
            windows_machine = False
            self.assertFalse(windows_machine, "Returned false because not on windows")

    def test_network_baseline(self):
        # needs to check that it opened the sockets not that there are open ports...
        self.assertIsNotNone(TEST.network_baseline())

if __name__ == '__main__':
    unittest.main()
